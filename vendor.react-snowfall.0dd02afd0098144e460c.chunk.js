"use strict";(self.webpackChunkpersonal_website=self.webpackChunkpersonal_website||[]).push([[877],{5418:(e,t,s)=>{s.d(t,{A:()=>k});var n=s(6540),a=s(115);function i(e,t){const s=Math.random()*(t-e+1)+e;return Number.isInteger(e)&&Number.isInteger(t)?Math.floor(s):s}function r(e,t,s){return(1-s)*e+s*t}function o(e){return e?{height:e.offsetHeight,width:e.offsetWidth}:{height:0,width:0}}const c=2*Math.PI,h={color:"#dee4fd",radius:[.5,3],speed:[1,3],wind:[-.5,2],changeFrequency:200,rotationSpeed:[-1,1]};class f{static createSnowflakes(e,t,s){if(!e)return[];const n=[];for(let a=0;a<t;a++)n.push(new f(e,s));return n}constructor(e,t={}){this.updateConfig(t);const{radius:s,wind:n,speed:a,rotationSpeed:r}=this.config;this.params={x:i(0,e.offsetWidth),y:i(-e.offsetHeight,0),rotation:i(0,360),radius:i(...s),speed:i(...a),wind:i(...n),rotationSpeed:i(...r),nextSpeed:i(...n),nextWind:i(...a),nextRotationSpeed:i(...r)},this.framesSinceLastUpdate=0}selectImage(){var e;this.config.images&&this.config.images.length>0?this.image=(e=this.config.images)[Math.floor(Math.random()*e.length)]:this.image=void 0}updateConfig(e){const t=this.config;this.config={...h,...e},this.config.changeFrequency=i(this.config.changeFrequency,1.5*this.config.changeFrequency),this.params&&!a(this.config.radius,null==t?void 0:t.radius)&&(this.params.radius=i(...this.config.radius)),a(this.config.images,null==t?void 0:t.images)||this.selectImage()}updateTargetParams(){this.params.nextSpeed=i(...this.config.speed),this.params.nextWind=i(...this.config.wind),this.image&&(this.params.nextRotationSpeed=i(...this.config.rotationSpeed))}update(e,t,s=1){const{x:n,y:a,rotation:i,rotationSpeed:o,nextRotationSpeed:c,wind:h,speed:f,nextWind:d,nextSpeed:u,radius:l}=this.params;this.params.x=(n+h*s)%(e+2*l),this.params.x>e+l&&(this.params.x=-l),this.params.y=(a+f*s)%(t+2*l),this.params.y>t+l&&(this.params.y=-l),this.image&&(this.params.rotation=(i+o)%360),this.params.speed=r(f,u,.01),this.params.wind=r(h,d,.01),this.params.rotationSpeed=r(o,c,.01),this.framesSinceLastUpdate++>this.config.changeFrequency&&(this.updateTargetParams(),this.framesSinceLastUpdate=0)}getImageOffscreenCanvas(e,t){var s,n;if(e instanceof HTMLImageElement&&e.loading)return e;let a=f.offscreenCanvases.get(e);if(a||(a={},f.offscreenCanvases.set(e,a)),!(t in a)){const n=document.createElement("canvas");n.width=t,n.height=t,null===(s=n.getContext("2d"))||void 0===s||s.drawImage(e,0,0,t,t),a[t]=n}return null!==(n=a[t])&&void 0!==n?n:e}drawCircle(e){e.moveTo(this.params.x,this.params.y),e.arc(this.params.x,this.params.y,this.params.radius,0,c)}drawImage(e){const{x:t,y:s,rotation:n,radius:a}=this.params,i=n*Math.PI/180,r=Math.cos(i),o=Math.sin(i);e.setTransform(r,o,-o,r,t,s);const c=this.getImageOffscreenCanvas(this.image,a);e.drawImage(c,-a/2,-a/2,a,a)}}f.offscreenCanvases=new WeakMap;const d=f,u={pointerEvents:"none",backgroundColor:"transparent",position:"absolute",top:0,left:0,width:"100%",height:"100%"},l=1e3/60;var p,g,m=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},w=function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s};class v{get ctx(){return m(this,p,"f")}get canvas(){return m(this,g,"f")}set canvas(e){w(this,g,e,"f"),w(this,p,e.getContext("2d"),"f")}constructor(e,t){this.lastUpdate=Date.now(),this.snowflakes=[],p.set(this,void 0),g.set(this,void 0),w(this,g,e,"f"),w(this,p,e.getContext("2d"),"f"),this.config={snowflakeCount:150,...h,...t},this.snowflakes=[],this.snowflakes=d.createSnowflakes(e,t.snowflakeCount||150,t),this.play()}updateConfig(e){this.config={...this.config,...e};const t=this.config.snowflakeCount-this.snowflakes.length;t>0&&(this.snowflakes=[...this.snowflakes,...d.createSnowflakes(this.canvas,t,e)]),t<0&&(this.snowflakes=this.snowflakes.slice(0,this.config.snowflakeCount));for(const e of this.snowflakes)e.updateConfig(this.config)}render(e=1){const{ctx:t,canvas:s,snowflakes:n}=this;if(!t||!s)return;const{offsetWidth:a,offsetHeight:i}=s;for(const t of n)t.update(a,i,e);if(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,a,i),this.config.images&&this.config.images.length>0)for(const e of n)e.drawImage(t);else{t.beginPath();for(const e of n)e.drawCircle(t);t.fillStyle=this.config.color,t.fill()}}loop(){const e=Date.now(),t=Date.now()-this.lastUpdate;this.lastUpdate=e;const s=t/l;this.render(s),this.animationFrame=requestAnimationFrame((()=>this.loop()))}play(){this.loop()}pause(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0)}}function y(e){const[t,s]=(0,n.useState)(e);return function(t,i){const r=(0,n.useRef)(i);a(i,r.current)||(r.current=i),(0,n.useEffect)((()=>s(e)),r.current)}(0,[e]),t}p=new WeakMap,g=new WeakMap;const k=({color:e=h.color,changeFrequency:t=h.changeFrequency,radius:s=h.radius,speed:a=h.speed,wind:i=h.wind,rotationSpeed:r=h.rotationSpeed,snowflakeCount:c=150,images:f,style:d}={})=>{const l=(p=d,(0,n.useMemo)((()=>({...u,...p||{}})),[p]));var p;const g=(0,n.useRef)(null),m=(e=>{const[t,s]=(0,n.useState)(o(e.current)),a=(0,n.useCallback)((()=>{e.current&&s(o(e.current))}),[e]);return(0,n.useEffect)((()=>{const{ResizeObserver:t}=window;if(e.current){if(a(),"function"==typeof t){const s=new t(a);return s.observe(e.current),()=>s.disconnect()}return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)}}),[e,a]),t})(g),w=y({color:e,changeFrequency:t,radius:s,speed:a,wind:i,rotationSpeed:r,images:f,snowflakeCount:c}),k=(0,n.useRef)(w),C=(0,n.useRef)();return(0,n.useEffect)((()=>(!C.current&&g.current&&(C.current=new v(g.current,k.current)),()=>{var e;null===(e=C.current)||void 0===e||e.pause(),C.current=void 0})),[]),(0,n.useEffect)((()=>{C.current&&C.current.updateConfig(w)}),[w]),n.createElement("canvas",{ref:g,height:m.height,width:m.width,style:l,"data-testid":"SnowfallCanvas"})}}}]);